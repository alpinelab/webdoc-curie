.video-wrapper
  %video#video-player.video-js.vjs-curie-skin{"data-setup" => '{ "controls": false, "preload": "auto", "autoplay": true}', :height => "auto", :poster => image_path("posters/#{current_page.data.poster}"), :"max-width" => "100%", "data-current-video" => 0}
    %source{:src => default_src, :type => "video/mp4"}
  .prev.control
  .pause.control
  .next.control

- content_for :javascripts do
  :coffeescript
    aspectRatio = 720/1280
    resizeVideoJS = ->
      player = $("#video-player")
      width = player.parent().width()
      $("#video-player").width(width).height(width * aspectRatio)
      $('.loader-image').width(width).height(width * aspectRatio)
    $(document).ready ->
      $(window).resize ->
        resizeVideoJS()
      videojs("video-player").ready ->
        resizeVideoJS()
        this.on 'loadeddata', ->
          $('.loader-image').transit({'opacity':0},500)
      $('.play, .pause').click ->
        element = $(this)
        videojs("video-player").ready ->
          if this.paused()
            this.play()
          else
            this.pause()
          element.toggleClass('play pause')
      $('.next').click ->
        videojs("video-player").ready ->
          current_video = $('#video-player').data('current-video')
          if current_video < $('.video-nav').length - 1
            $('#video-player').data('current-video',current_video + 1)
            $('.video-nav').eq(current_video+1).find('img').click()
      $('.prev').click ->
        videojs("video-player").ready ->
          current_video = $('#video-player').data('current-video')
          if current_video > 0
            $('#video-player').data('current-video',current_video - 1)
            $('.video-nav').eq(current_video-1).find('img').click()
